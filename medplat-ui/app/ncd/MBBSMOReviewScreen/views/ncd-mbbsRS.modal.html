<style>
    .outer-tabset>.nav.nav-tabs {
        background: #ffffff;
        border: 1px solid #dfdfdf;
        padding-bottom: 1px;
    }

    .table-heading {
        background-color: rgb(241, 241, 241);
        position: relative;
        top: -1px;
    }
</style>
<script>
    $(".header-fixed").tableHeadFixer();
</script>
<!-- all member listing tabs -->
<div class="container-fluid">
    <div class="row">
        <div class="col-12 mb-15">
            <button class="btn btn-primary pull-right" ng-click="ncdrs.downloadExcel()">Download Excel</button>
            <div class="cst-tab">
                <uib-tabset active='ncdrs.selectedTab'>
                    <!-- member list tab -->
                    <uib-tab heading="Patient List" index=0 ng-click="ncdrs.retrieveMemberList('patientList',true)">
                        <div class="cst-table table-responsive table-set-height" id="member-scroll">
                            <table aria-describedby="member list" ng-if="!ncdrs.isSearch"
                                class="table table-sm  header-fixed table-striped table-bordered header-fixed vertical-middle">
                                <thead class="cst-thead">
                                    <tr>
                                        <th id="patient-name" class="table-heading">Patient Name</th>
                                        <th id="age" class="table-heading">Age</th>
                                        <th id="gender">Gender</th>
                                        <th id="Village" class="table-heading">Village</th>
                                        <th id="subCenter" class="table-heading">Sub Center</th>
                                        <th id="status">Status</th>
                                        <th id="diseaseSummary">Disease(s)</th>
                                        <th id="actions" class="table-heading">Actions</th>
                                    </tr>
                                </thead>
                                <tbody infinite-scroll-distance="0"
                                    infinite-scroll="ncdrs.retrieveMemberList('patientList',false)"
                                    infinite-scroll-container='"#member-scroll"'
                                    infinite-scroll-immediate-check="false">
                                    <tr ng-repeat="member in ncdrs.membersSearchList">
                                        <td ng-bind="member.name | emptylabel"></td>
                                        <td ng-bind="member.age | emptylabel"></td>
                                        <td ng-bind="member.gender | emptylabel"></td>
                                        <td ng-bind="member.village | emptylabel"></td>
                                        <td ng-bind="member.subCenter | emptylabel"></td>
                                        <td ng-bind-html="member.statusDisplay| titlecase |emptylabel"></td>
                                        <td ng-bind-html="member.diseaseSummary| titlecase |emptylabel"></td>
                                        <td class="action-cell">
                                            <button
                                                ui-sref="techo.ncd.moreviewpatientsummary({id:member.id,type:ncdrs.type})"
                                                class="btn btn-primary">Examine</button>
                                        </td>
                                    </tr>
                                    <tr ng-if="!ncdrs.membersSearchList || ncdrs.membersSearchList.length==0">
                                        <td colspan="8">No Members Referred </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table aria-describedby="member list" ng-if="ncdrs.isSearch"
                                class="table table-sm  header-fixed table-striped table-bordered header-fixed vertical-middle">
                                <thead class="cst-thead">
                                    <tr>
                                        <th id="patient-name" class="table-heading">Patient Name</th>
                                        <th id="age" class="table-heading">Age</th>
                                        <th id="gender">Gender</th>
                                        <th id="Village" class="table-heading">Village</th>
                                        <th id="subCenter" class="table-heading">Sub Center</th>
                                        <th id="status">Status</th>
                                        <th id="diseaseSummary">Disease(s)</th>
                                        <th id="actions" class="table-heading">Actions</th>
                                    </tr>
                                </thead>
                                <tbody infinite-scroll-distance="0" infinite-scroll='ncdrs.searchMembers(false)'
                                    infinite-scroll-container='"#member-scroll"'
                                    infinite-scroll-immediate-check="false">
                                    <tr ng-repeat="member in ncdrs.membersSearchList">
                                        <td ng-bind="member.name | emptylabel"></td>
                                        <td ng-bind="member.age | emptylabel"></td>
                                        <td ng-bind="member.gender | emptylabel"></td>
                                        <td ng-bind="member.village | emptylabel"></td>
                                        <td ng-bind="member.subCenter | emptylabel"></td>
                                        <td ng-bind-html="member.status| titlecase |emptylabel"></td>
                                        <td ng-bind-html="member.diseaseSummary| titlecase |emptylabel"></td>
                                        <td class="action-cell">
                                            <button
                                                ui-sref="techo.ncd.moreviewpatientsummary({id:member.id,type:ncdrs.type})"
                                                class="btn btn-primary">Examine</button>
                                        </td>
                                    </tr>
                                    <tr ng-if="!ncdrs.membersSearchList || ncdrs.membersSearchList.length==0">
                                        <td colspan="8">No Members Referred </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </uib-tab>

                </uib-tabset>
            </div>
        </div>
    </div>
</div>
<!-- search tab -->
<div class="large-div filter-div " ng-if="ncdrs.selectedTab===0">
    <span style="left:-66px" class="filter-toggle" ng-click="ncdrs.toggleFilter()">Search</span>
    <div class="row">
        <div class="col-12">
            <h5 class="filter-div-title">Search Members</h5>
        </div>
    </div>
    <div class="filter-div-body">
        <form name="ncdrs.searchForm" novalidate>
            <div class="row">
                <div class="col-12">
                    <div class="form-group">
                        <label>Search By: </label>
                        <br>
                        <label class="control control-radio"> Unique health ID
                            <input type="radio" name="search" icheck ng-model="ncdrs.search.searchBy"
                                value="uniqueHealthId" ng-change="ncdrs.search.searchString = null;" />
                            <div class="control_indicator"></div>
                        </label>
                        <label class="control control-radio"> Mobile no.
                            <input type="radio" name="search" icheck ng-model="ncdrs.search.searchBy" value="mobileNo"
                                ng-change="ncdrs.search.searchString = null;" />
                            <div class="control_indicator"></div>
                        </label>
                        <!-- <label class="control control-radio"> Organization Unit
                            <input type="radio" name="search" icheck ng-model="ncdrs.search.searchBy" value="orgUnit"
                                ng-change="ncdrs.search.searchString = null; ncdrs.selectedLocation = null;" />
                            <div class="control_indicator"></div>
                        </label> -->
                        <!-- <label class="control control-radio" style="min-width: auto;"> Name
                            <input type="radio" name="search" icheck ng-model="ncdrs.search.searchBy" value="name"
                                ng-change="ncdrs.search.searchString = null; ncdrs.selectedLocation = null; ncdrs.search.locationToSearchByName = null;" />
                            <div class="control_indicator"></div>
                        </label> -->
                        <!-- <label class="control control-radio"> Disease
                            <input type="radio" name="search" icheck ng-model="ncdrs.search.searchBy" value="disease"
                                ng-change="ncdrs.search.searchString = 'All';" />
                            <div class="control_indicator"></div>
                        </label> -->
                        <!-- <label class="control control-radio"> Sub center name
                            <input type="radio" name="search" icheck ng-model="ncdrs.search.searchBy"
                                value="subCenterName" ng-change="ncdrs.search.searchString = null; ncdrs.retrieveSC()" />
                            <div class="control_indicator"></div>
                        </label> -->
                        <label class="control control-radio"> Status
                            <input type="radio" name="search" icheck ng-model="ncdrs.search.searchBy" value="status"
                                ng-change="ncdrs.search.searchString = 'All';" />
                            <div class="control_indicator"></div>
                        </label>
                        <br><br>
                        <div class="form-group" ng-if="ncdrs.search.searchBy === 'status'">
                            <label for="status" control-label>
                                Select Status
                            </label>
                            <select class="form-control cst-form-control" form-control chosen-directive multiple
                                ng-model="ncdrs.search.searchString" name="status" id="status">
                                <option value="SUSPECTED">Suspected</option>
                                <option value="UNDERTREATMENT">Undertreatment</option>
                                <option value="UNDERTREATMENT_CONTROLLED">Undertreatment controlled</option>
                                <option value="UNDERTREATMENT_UNCONTROLLED">Undertreatment uncontrolled</option>
                                <option value="CONFIRMED">Confirmed</option>
                                <option value="FOLLOWUP">Followup</option>
                                <option value="NORMAL">Normal</option>
                                <option value="REFERRED_MO">Referred MO</option>
                                <option value="REFERRED_CONSULTANT">Referred Consultant</option>
                                <option value="REFERRED_BACK_MO">Referred Back MO</option>
                                <option value="REFERRED_BACK_CONSULTANT">Referred Back CONSULTANT</option>
                                <option value="REFERRED_HIGHER_CENTER">Referred Higher Center</option>
                                <!-- <option value="MEDICINE_CHANGE">Patients with changes in Medicine</option>
                                <option value="MEDICINE_NO_CHANGE">Patients with no changes in Medicine</option> -->
                            </select>
                        </div>
                        <!-- <div class="form-group" ng-if="ncdrs.search.searchBy === 'disease'">
                            <label for="disease" control-label>
                                Select Disease
                            </label>
                            <select class="form-control cst-form-control" form-control
                                ng-model="ncdrs.search.searchString" name="disease" id="disease">
                                <option value="All" selected>All</option>
                                <option value="HT">Hypertension</option>
                                <option value="D">Diabetes</option>
                                <option value="O">Oral</option>
                                <option value="B">Breast</option>
                                <option value="C">Cervical</option>
                            </select>
                        </div> -->
                        <!-- <div class="form-group" ng-if="ncdrs.search.searchBy === 'name'">
                            <location-directive template-type="'twoPart'"
                                ng-model="ncdrs.search.locationToSearchByName"
                                selected-location="ncdrs.selectedLocation" required-upto-level="3"
                                template-type="'inline'" fetch-according-to-user-aoi="false">
                            </location-directive>
                        </div> -->
                        <!-- <div class="form-group" ng-if="ncdrs.search.searchBy === 'orgUnit'">
                            <location-directive template-type="'twoPart'" ng-model="ncdrs.search.searchString"
                                selected-location="ncdrs.selectedLocation" required-upto-level="3"
                                template-type="'inline'" fetch-according-to-user-aoi="false"> </location-directive>
                        </div>
                        <div class="form-group" ng-if="ncdrs.search.searchBy === 'subCenterName'">
                            <label for="subCenterName" control-label>
                                Select Sub-center
                            </label>
                            <select class="form-control cst-form-control" form-control
                                ng-model="ncdrs.search.searchString" name="subCenterName" id="subCenterName"
                                ng-options="subCenter.id as subCenter.name for subCenter in ncdrs.subCenters">
                                <option value="">Select</option>
                            </select>
                        </div> -->
                        <div class="form-group" style="margin-top: 10px">
                            <validate for="searchString" required-msg='Enter {{ncdrs.search.searchBy}}'
                                ng-if="ncdrs.search.searchBy === 'uniqueHealthId' || ncdrs.search.searchBy === 'familyId' || ncdrs.search.searchBy === 'abha number' || ncdrs.search.searchBy === 'abha address'">
                                <input type="text" name="searchString" form-control ng-model="ncdrs.search.searchString"
                                    placeholder="Enter {{ncdrs.search.searchBy}}" class="form-control" required />
                                <placeholder></placeholder>
                            </validate>
                        </div>
                        <div class="form-group" ng-if="ncdrs.search.searchBy === 'mobileNo'">
                            <validate for="mobileNo" required-msg='Enter {{ncdrs.search.searchBy}}'
                                maxlength-msg="Invalid mobile number. Enter 10 digits"
                                minlength-msg="Invalid mobile number. Enter 10 digits">
                                <input type="text" numbers-only name="mobileNo" form-control
                                    ng-model="ncdrs.search.searchString" placeholder="Enter {{ncdrs.search.searchBy}}"
                                    max-length="10" min-length="10" class="form-control" required />
                                <placeholder></placeholder>
                            </validate>
                        </div>
                        <!-- <div style="margin-top: 10px">
                            <validate for="searchString" pattern-msg='Enter Valid details'
                                ng-if="ncdrs.search.searchBy === 'name'">
                                <input style="width:30%;float:left;margin:4px" type="text" name="firstName" form-control
                                    ng-model="ncdrs.search.firstName" placeholder="Enter first Name"
                                    class="form-control" required />
                            </validate>
                            <validate for="searchString" pattern-msg='Enter Valid details'
                                ng-if="ncdrs.search.searchBy === 'name'">
                                <input style="width:30%;float:left;margin:4px" type="text" name="middleName"
                                    form-control ng-model="ncdrs.search.middleName" placeholder="Enter middle Name"
                                    class="form-control" />
                            </validate>
                            <validate for="searchString" pattern-msg='Enter Valid details'
                                ng-if="ncdrs.search.searchBy === 'name'">
                                <input style="width:30%;float:left;margin:4px" type="text" name="lastName" form-control
                                    ng-model="ncdrs.search.lastName" placeholder="Enter last Name"
                                    class="form-control" required />
                            </validate>
                        </div>                  -->
                    </div>
                </div>
                <div class="col-12">
                    <hr>
                    <div class="form-group text-right">
                        <button class="btn btn-secondary close-filter" ng-click="ncdrs.toggleFilter()">Close</button>
                        <button type="submit" class="btn btn-primary search-filter"
                            ng-click="ncdrs.searchMembers(true)">Search</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
<div class="cst-backdrop"></div>